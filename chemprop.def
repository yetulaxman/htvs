Bootstrap: docker
From: continuumio/miniconda3:4.9.2

%labels
Laxmana Yetukuri <laxmana.yetukuri@csc.fi>

%setup
 cp environment.yml /tmp/environment.yml
 cp chemprop-1.3.1_mod.tar.gz /tmp/

%environment
 export PATH="/opt/conda/envs/chemprop/bin:/opt/conda/condabin:/opt/conda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

%post
  apt-get -y update --allow-releaseinfo-change
  apt-get install -y vim htop procps
  /opt/conda/bin/conda env create -f /tmp/environment.yml
  echo ". /opt/conda/etc/profile.d/conda.sh" >> $SINGULARITY_ENVIRONMENT
  echo "conda activate chemprop_mod" >> $SINGULARITY_ENVIRONMENT
